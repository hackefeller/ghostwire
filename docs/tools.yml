version: 1
source: agents/tools.yml
description: Map of tool directories with detailed descriptions. Keep in sync with src/execution/tools directory changes.

tools:
  # === Code Analysis & Transformation ===

  - id: ast-grep
    path: src/execution/tools/ast-grep
    purpose: AST-based code search and replace using ast-grep CLI
    description: |
      Uses Abstract Syntax Tree (AST) matching instead of regex for precise code search/replace.
      Supports 25+ languages (JavaScript, TypeScript, Python, Go, Rust, etc.).
      ast_grep_search: Finds code patterns across the filesystem.
      ast_grep_replace: Replaces patterns with AST-aware rewriting, preserving structure.
      Uses meta-variables ($VAR for single capture, $$$ for multiple).

  - id: grep
    path: src/execution/tools/grep
    purpose: Fast content search using regular expressions with file filtering
    description: |
      Searches file contents using full regex syntax.
      Filter files by pattern with include parameter (e.g., *.js, *.{ts,tsx}).
      Returns file paths with matches sorted by modification time.
      Safety limits: 60-second timeout, 10MB output limit.

  - id: glob
    path: src/execution/tools/glob
    purpose: Fast file pattern matching for finding files by glob patterns
    description: |
      Uses ripgrep's --files mode internally for fast file discovery.
      Supports glob patterns like **/*.js or src/**/*.ts.
      Returns matching file paths sorted by modification time.
      Safety limits: 60-second timeout, 100 file limit.

  - id: lsp
    path: src/execution/tools/lsp
    purpose: IDE-like language server features for code navigation and refactoring
    description: |
      Provides LSP tools: goto_definition, find_references, symbols, diagnostics, prepare_rename, rename.
      Works with any LSP-compatible language server.
      lsp_goto_definition: Jump to symbol definition.
      lsp_find_references: Find all usages across workspace.
      lsp_symbols: Get document/workspace symbols.
      lsp_diagnostics: Get errors/warnings/hints before building.
      lsp_rename: Rename symbol across entire workspace.

  # === Task & Background Management ===

  - id: background-task
    path: src/execution/tools/background-task
    purpose: Run, monitor, and manage asynchronous agent tasks in background
    description: |
      Launches agent tasks that run in background with immediate task_id return.
      background_task: Launch background agent task.
      background_output: Retrieve output, can block and wait or return immediately.
      background_cancel: Cancel running/pending tasks.
      background_task_list: List tasks with optional filtering.
      background_task_info: Get detailed task info (timing, progress, errors).
      background_task_update: Update task - supports retry for failed/cancelled.
      Task states: pending, running, completed, error, cancelled.

  - id: todo-manager
    path: src/execution/tools/todo-manager
    purpose: Manage todo items within sessions for tracking work progress
    description: |
      todo_create: Create new todo with content, priority, optional notes.
      todo_list: List todos with filtering by status/priority.
      todo_update: Update content, status, priority, or notes.
      todo_delete: Delete todo with safety checks for in-progress items.
      Status values: pending, in_progress, completed, cancelled.
      Priority levels: low, medium, high, critical.

  - id: delegate-task
    path: src/execution/tools/delegate-task
    purpose: Spawn agent tasks with category-based or direct agent selection, with skill injection
    description: |
      Category-based delegation: Predefined categories (explore, code, review) map to specific agents.
      Direct agent selection: Specify agent name directly (e.g., "eye-ops", "scan-ops").
      Skill injection: Load skills dynamically via load_skills parameter.
      Session continuation: Use session_id to preserve context across sessions.
      Unstable agent detection: Gemini models auto-convert sync to background mode.

  - id: call-omo-agent
    path: src/execution/tools/call-omo-agent
    purpose: Spawn specialized subagent tasks (scan-ops, data-dive) with background/sync modes
    description: |
      Spawns specific subagents: scan-ops (reconnaissance), data-dive (archival research).
      Supports synchronous (waits for completion) and asynchronous (background) modes.
      Session continuation via session_id parameter.
      Case-insensitive agent name matching.
      run_in_background=true: Returns task_id immediately.
      run_in_background=false: Polls for completion, returns results directly.

  # === Session Management ===

  - id: session-manager
    path: src/execution/tools/session-manager
    purpose: Manage OpenCode sessions - list, read, search, create, update, delete
    description: |
      session_list: List sessions with date/project path filtering.
      session_read: Read messages from session, optionally including todos/transcripts.
      session_search: Search text across sessions with case-sensitivity options.
      session_info: Get detailed session metadata.
      session_create: Create new sessions, optionally as child sessions.
      session_update: Update session metadata (title, description).
      session_delete: Delete sessions with cascade options.
      Stores session data in JSON files organized by project.

  # === Skills & Commands ===

  - id: skill
    path: src/execution/tools/skill
    purpose: Load and manage agent skills that provide specialized instructions
    description: |
      Loads skill definitions from the skill registry.
      Skills provide specialized knowledge and step-by-step guidance.
      Supports skill restrictions (some skills only work with specific agents).
      Displays available skills in tool description with XML format.
      Dynamically discovers skills from configured paths.
      Formats MCP server tools/resources/prompts as part of skill output.

  - id: skill-mcp
    path: src/execution/tools/skill-mcp
    purpose: Invoke MCP (Model Context Protocol) servers embedded in skills
    description: |
      Calls MCP tools, reads MCP resources, or gets MCP prompts defined in skills.
      tool_name: Call an MCP tool with arguments.
      resource_name: Read an MCP resource by URI.
      prompt_name: Get an MCP prompt with arguments.
      grep: Optional regex filter on output lines.
      Validates exactly one of tool/resource/prompt must be specified.

  - id: slashcommand
    path: src/execution/tools/slashcommand
    purpose: Execute slash commands and load skills as commands
    description: |
      Discovers slash commands from multiple sources:
      - Built-in commands (from builtin-commands)
      - OpenCode global commands (~/.config/opencode/command/)
      - OpenCode project commands (.opencode/command/)
      - Claude Code user commands (~/.claude/commands/)
      - Claude Code project commands (.claude/commands/)
      Also includes skills as executable commands.
      Supports command scopes: builtin, user, project, opencode, opencode-project.

  # === Terminal & File Operations ===

  - id: interactive-bash
    path: src/execution/tools/interactive-bash
    purpose: Execute tmux commands for terminal interaction and session management
    description: |
      Safe wrapper around tmux commands for terminal interaction.
      Includes command tokenization with quote handling.
      Blocks dangerous subcommands with helpful redirect messages.
      Uses Bun's spawn for process execution with 300s default timeout.
      Returns stdout on success, error messages on failure.

  - id: look-at
    path: src/execution/tools/look-at
    purpose: Analyze files (images, PDFs, videos, text) using multimodal vision models
    description: |
      Sends files to multimodal agent ("analyzer-media") for analysis.
      Supports: images (jpg, png, webp, heic), videos (mp4, mov, webm), PDFs, audio, text.
      Uses MIME type inference based on file extension.
      Requires file_path (absolute) and goal (what to extract/analyze).
      Creates child session for analysis, returns model response.

notes:
  - Keep this file in sync with src/execution/tools directory changes.
  - Tools are organized by category: Code Analysis, Task Management, Session Management, Skills/Commands, Terminal/File Operations.
